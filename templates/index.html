<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assaultron Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .resize-handle {
            background: #e5e5e5;
            cursor: ew-resize;
            width: 4px;
            min-height: 100%;
        }
        .resize-handle:hover {
            background: #999;
        }
        .panel {
            min-width: 300px;
        }
    </style>
</head>
<body class="bg-white text-gray-900 min-h-screen font-mono">
    <div class="h-screen flex flex-col">
        <!-- Tab Navigation -->
        <div class="bg-gray-100 border-b border-gray-300">
            <nav class="flex space-x-4 px-3">
                <button onclick="switchTab('interface')" id="tabInterface" class="tab-button active py-2 px-4 text-sm font-bold border-b-2 border-blue-500">INTERFACE</button>
                <button onclick="switchTab('realBody')" id="tabRealBody" class="tab-button py-2 px-4 text-sm font-bold border-b-2 border-transparent hover:border-gray-400">REAL BODY</button>
            </nav>
        </div>
        
        <!-- Interface Tab Content -->
        <div id="interfaceTab" class="flex-1 flex tab-content">
            <!-- Logs Panel -->
            <div id="logsPanel" class="panel bg-gray-50 border-r border-gray-300 flex flex-col" style="width: 50%;">
                <div class="p-3 bg-gray-100 border-b border-gray-300">
                    <h2 class="text-sm font-bold">System Logs</h2>
                </div>
                <div id="systemLogs" class="flex-1 p-3 overflow-y-auto text-xs space-y-1 bg-white">
                    <div class="text-blue-600">[INFO] Interface initialized</div>
                </div>
            </div>
            
            <!-- Resize Handle -->
            <div class="resize-handle" id="resizeHandle"></div>
            
            <!-- Chat Panel -->
            <div id="chatPanel" class="panel flex-1 flex flex-col">
                <div class="p-3 bg-gray-100 border-b border-gray-300">
                    <h2 class="text-sm font-bold">Chat</h2>
                </div>
                <div id="chatHistory" class="flex-1 p-3 overflow-y-auto text-sm space-y-2 bg-white">
                    <div class="text-green-600 font-bold">ASSAULTRON UNIT ASR-7 ONLINE - AWAITING OPERATOR COMMANDS</div>
                </div>
                <div class="p-3 border-t border-gray-300 bg-gray-50">
                    <div class="flex gap-2">
                        <input 
                            type="text" 
                            id="chatInput" 
                            placeholder="ENTER COMMAND OR COMMUNICATION..."
                            class="flex-1 px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-blue-500"
                        >
                        <button 
                            id="sendBtn"
                            class="px-4 py-2 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 disabled:bg-gray-400"
                        >
                            TRANSMIT
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Real Body Tab Content -->
        <div id="realBodyTab" class="flex-1 flex tab-content hidden">
            <!-- Hardware Status Panel -->
            <div class="flex-1 p-4 bg-white">
                <h2 class="text-lg font-bold mb-4 text-green-600">ASSAULTRON HARDWARE STATUS</h2>
                
                <!-- LED Control Section -->
                <div class="mb-6 p-4 border border-gray-300 rounded bg-gray-50">
                    <h3 class="font-bold text-sm mb-3">LED INTENSITY CONTROL</h3>
                    <div class="flex items-center gap-4">
                        <div class="flex-1">
                            <input type="range" id="ledSlider" min="0" max="100" value="50" 
                                   class="w-full h-2 bg-gray-300 rounded outline-none"
                                   onchange="setLedManually(this.value)">
                        </div>
                        <div class="text-center min-w-[60px]">
                            <div id="ledValue" class="font-bold text-lg">50%</div>
                            <div class="w-8 h-8 border-2 border-gray-400 rounded-full mx-auto mt-1" id="ledIndicator" style="background-color: rgb(128, 128, 128);"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Hand Controls Section -->
                <div class="mb-6 p-4 border border-gray-300 rounded bg-gray-50">
                    <h3 class="font-bold text-sm mb-3">HAND MOVEMENT CONTROL</h3>
                    
                    <!-- Left Hand -->
                    <div class="mb-4">
                        <h4 class="font-bold text-xs mb-2 text-blue-600">LEFT HAND</h4>
                        <div class="flex items-center gap-4">
                            <div class="flex-1">
                                <input type="range" id="leftHandSlider" min="0" max="100" value="0" 
                                       class="w-full h-2 bg-gray-300 rounded outline-none"
                                       onchange="setHandManually('left', this.value)">
                            </div>
                            <div class="text-center min-w-[80px]">
                                <div id="leftHandValue" class="font-bold">0% (closed)</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Hand -->
                    <div class="mb-4">
                        <h4 class="font-bold text-xs mb-2 text-blue-600">RIGHT HAND</h4>
                        <div class="flex items-center gap-4">
                            <div class="flex-1">
                                <input type="range" id="rightHandSlider" min="0" max="100" value="0" 
                                       class="w-full h-2 bg-gray-300 rounded outline-none"
                                       onchange="setHandManually('right', this.value)">
                            </div>
                            <div class="text-center min-w-[80px]">
                                <div id="rightHandValue" class="font-bold">0% (closed)</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Memory Banks Section -->
                <div class="mb-6 p-4 border border-gray-300 rounded bg-gray-50">
                    <h3 class="font-bold text-sm mb-3">MEMORY BANKS</h3>
                    <div id="memoryDisplay" class="text-xs space-y-1 max-h-32 overflow-y-auto">
                        <div class="text-gray-500">Memory banks empty</div>
                    </div>
                </div>
                
                <!-- Voice System Section -->
                <div class="mb-6 p-4 border border-gray-300 rounded bg-gray-50">
                    <h3 class="font-bold text-sm mb-3">ASSAULTRON VOICE SYSTEM</h3>
                    <div class="space-y-3">
                        <div class="flex items-center gap-4">
                            <button id="voiceStartBtn" onclick="startVoiceServer()" 
                                    class="px-4 py-2 bg-red-500 text-white rounded text-sm hover:bg-red-600 disabled:bg-gray-400">
                                ðŸš€ START VOICE SERVER
                            </button>
                            <button id="voiceStopBtn" onclick="stopVoiceServer()" 
                                    class="px-4 py-2 bg-gray-500 text-white rounded text-sm hover:bg-gray-600 disabled:bg-gray-400" disabled>
                                ðŸ›‘ STOP VOICE SERVER
                            </button>
                        </div>
                        <div id="voiceStatus" class="text-sm">
                            <div class="flex items-center gap-2">
                                <span id="voiceStatusText" class="text-red-500">Voice system offline</span>
                                <div id="voiceStatusIndicator" class="w-2 h-2 rounded-full bg-red-500"></div>
                            </div>
                            <div id="voiceDetails" class="text-xs text-gray-600 mt-1">
                                Server: <span id="serverStatus">Stopped</span> | 
                                Model: <span id="modelStatus">Not loaded</span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <input type="text" id="testSpeechInput" placeholder="Test speech..." 
                                   class="flex-1 px-3 py-2 border border-gray-300 rounded text-sm">
                            <button onclick="testSpeech()" 
                                    class="px-4 py-2 bg-green-500 text-white rounded text-sm hover:bg-green-600 disabled:bg-gray-400">
                                TEST
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Stats Section -->
        <div class="border-t border-gray-300 bg-gray-50 p-3">
            <div class="grid grid-cols-6 gap-4 text-xs">
                <div class="text-center">
                    <div class="text-gray-500">API Status</div>
                    <div id="apiStatus" class="font-bold text-red-500">Offline</div>
                </div>
                <div class="text-center">
                    <div class="text-gray-500">Response Time</div>
                    <div id="responseTime" class="font-bold">-</div>
                </div>
                <div class="text-center">
                    <div class="text-gray-500">Ping</div>
                    <div id="ping" class="font-bold">-</div>
                </div>
                <div class="text-center">
                    <div class="text-gray-500">Messages</div>
                    <div id="messageCount" class="font-bold">0</div>
                </div>
                <div class="text-center">
                    <div class="text-gray-500">Model</div>
                    <div id="modelName" class="font-bold">-</div>
                </div>
                <div class="text-center">
                    <div class="text-gray-500">Uptime</div>
                    <div id="uptime" class="font-bold">-</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let messageCount = 0;
        let startTime = Date.now();
        let lastPingTime = 0;
        let currentTab = 'interface';

        // DOM elements
        const logsPanel = document.getElementById('logsPanel');
        const chatPanel = document.getElementById('chatPanel');
        const resizeHandle = document.getElementById('resizeHandle');
        const systemLogs = document.getElementById('systemLogs');
        const chatHistory = document.getElementById('chatHistory');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');

        // Stats elements
        const apiStatus = document.getElementById('apiStatus');
        const responseTimeEl = document.getElementById('responseTime');
        const pingEl = document.getElementById('ping');
        const messageCountEl = document.getElementById('messageCount');
        const modelNameEl = document.getElementById('modelName');
        const uptimeEl = document.getElementById('uptime');

        // Panel resizing
        let isResizing = false;

        resizeHandle.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.addEventListener('mousemove', handleResize);
            document.addEventListener('mouseup', stopResize);
        });

        function handleResize(e) {
            if (!isResizing) return;
            
            const containerWidth = window.innerWidth;
            const newWidth = (e.clientX / containerWidth) * 100;
            
            if (newWidth > 20 && newWidth < 80) {
                logsPanel.style.width = `${newWidth}%`;
            }
        }

        function stopResize() {
            isResizing = false;
            document.removeEventListener('mousemove', handleResize);
            document.removeEventListener('mouseup', stopResize);
        }

        // Logging
        function addLog(level, message) {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                INFO: 'text-blue-600',
                WARN: 'text-yellow-600',
                WARNING: 'text-orange-600',
                ERROR: 'text-red-600',
                AI: 'text-green-600',
                CONTEXT: 'text-purple-600',
                ACTION: 'text-indigo-600',
                TOOL: 'text-teal-600',
                VOICE: 'text-pink-600'
            };
            
            const logDiv = document.createElement('div');
            logDiv.className = colors[level] || 'text-gray-600';
            logDiv.textContent = `[${timestamp}] [${level}] ${message}`;
            
            systemLogs.appendChild(logDiv);
            systemLogs.scrollTop = systemLogs.scrollHeight;
            
            // Keep only last 100 logs
            while (systemLogs.children.length > 100) {
                systemLogs.removeChild(systemLogs.firstChild);
            }
        }

        // Chat functions
        function addChatMessage(sender, message) {
            const timestamp = new Date().toLocaleTimeString();
            const div = document.createElement('div');
            
            if (sender === 'USER') {
                div.innerHTML = `<div class="text-right"><span class="text-gray-500">[${timestamp}]</span> <span class="text-blue-600 font-bold">OPERATOR:</span> ${message}</div>`;
            } else if (sender === 'ASSAULTRON') {
                div.innerHTML = `<div><span class="text-gray-500">[${timestamp}]</span> <span class="text-green-600 font-bold">ASR-7:</span> ${message}</div>`;
            } else {
                div.innerHTML = `<div><span class="text-gray-500">[${timestamp}]</span> <span class="text-gray-600 font-bold">${sender}:</span> ${message}</div>`;
            }
            
            chatHistory.appendChild(div);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        // API functions
        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            addChatMessage('USER', message);
            chatInput.value = '';
            sendBtn.disabled = true;
            sendBtn.textContent = 'TRANSMITTING';
            
            const startTime = performance.now();
            
            try {
                addLog('AI', `Sending: ${message.substring(0, 50)}...`);
                
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: message })
                });

                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                if (response.ok) {
                    const data = await response.json();
                    addChatMessage('ASSAULTRON', data.response);
                    messageCount++;
                    messageCountEl.textContent = messageCount;
                    responseTimeEl.textContent = `${responseTime}ms`;
                    addLog('AI', `Response received (${responseTime}ms)`);
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
                
            } catch (error) {
                addChatMessage('SYSTEM', `Error: ${error.message}`);
                addLog('ERROR', `Chat failed: ${error.message}`);
                responseTimeEl.textContent = 'Error';
            }

            sendBtn.disabled = false;
            sendBtn.textContent = 'TRANSMIT';
        }

        async function updateStats() {
            const pingStart = performance.now();
            
            try {
                const response = await fetch('/api/status');
                const pingEnd = performance.now();
                const ping = Math.round(pingEnd - pingStart);
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Update status indicators
                    if (data.ai_active) {
                        apiStatus.textContent = 'Online';
                        apiStatus.className = 'font-bold text-green-500';
                    } else {
                        apiStatus.textContent = 'Offline';
                        apiStatus.className = 'font-bold text-red-500';
                    }
                    
                    pingEl.textContent = `${ping}ms`;
                    pingEl.className = ping < 100 ? 'font-bold text-green-500' : 
                                      ping < 500 ? 'font-bold text-yellow-500' : 'font-bold text-red-500';
                    
                    // Update other stats
                    messageCountEl.textContent = data.conversation_count || messageCount;
                    
                } else {
                    throw new Error('Status check failed');
                }
                
            } catch (error) {
                apiStatus.textContent = 'Error';
                apiStatus.className = 'font-bold text-red-500';
                pingEl.textContent = 'Error';
                addLog('ERROR', `Stats update failed: ${error.message}`);
            }
        }

        async function getModelInfo() {
            try {
                const response = await fetch('http://localhost:11434/api/tags');
                if (response.ok) {
                    const data = await response.json();
                    if (data.models && data.models.length > 0) {
                        modelNameEl.textContent = data.models[0].name;
                    }
                }
            } catch (error) {
                modelNameEl.textContent = 'Unknown';
            }
        }

        function updateUptime() {
            const elapsed = Date.now() - startTime;
            const seconds = Math.floor(elapsed / 1000) % 60;
            const minutes = Math.floor(elapsed / 60000) % 60;
            const hours = Math.floor(elapsed / 3600000);
            
            uptimeEl.textContent = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
        
        // Voice system event listeners
        document.getElementById('testSpeechInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') testSpeech();
        });

        // Tab Management
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Hide all tabs
            document.getElementById('interfaceTab').classList.toggle('hidden', tabName !== 'interface');
            document.getElementById('realBodyTab').classList.toggle('hidden', tabName !== 'realBody');
            
            // Update tab buttons
            document.getElementById('tabInterface').classList.toggle('active', tabName === 'interface');
            document.getElementById('tabInterface').classList.toggle('border-blue-500', tabName === 'interface');
            document.getElementById('tabInterface').classList.toggle('border-transparent', tabName !== 'interface');
            
            document.getElementById('tabRealBody').classList.toggle('active', tabName === 'realBody');
            document.getElementById('tabRealBody').classList.toggle('border-blue-500', tabName === 'realBody');
            document.getElementById('tabRealBody').classList.toggle('border-transparent', tabName !== 'realBody');
            
            if (tabName === 'realBody') {
                updateHardwareStatus();
                updateMemoryDisplay();
            }
        }

        // Hardware Control Functions
        async function setLedManually(intensity) {
            try {
                const response = await fetch('/api/hardware/led', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ intensity: parseInt(intensity) })
                });
                
                if (response.ok) {
                    updateLedDisplay(intensity);
                    addLog('MANUAL', `LED set to ${intensity}%`);
                }
            } catch (error) {
                addLog('ERROR', `LED control failed: ${error.message}`);
            }
        }

        async function setHandManually(hand, position) {
            try {
                const response = await fetch('/api/hardware/hands', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ hand: hand, position: parseInt(position) })
                });
                
                if (response.ok) {
                    updateHandDisplay(hand, position);
                    addLog('MANUAL', `Hand ${hand} set to ${position}%`);
                }
            } catch (error) {
                addLog('ERROR', `Hand control failed: ${error.message}`);
            }
        }

        function updateLedDisplay(intensity) {
            document.getElementById('ledValue').textContent = `${intensity}%`;
            document.getElementById('ledSlider').value = intensity;
            
            // Update LED indicator color
            const colorValue = Math.floor((intensity / 100) * 255);
            document.getElementById('ledIndicator').style.backgroundColor = `rgb(${colorValue}, ${colorValue}, ${colorValue})`;
        }

        function updateHandDisplay(hand, position) {
            const statusText = position <= 10 ? 'closed' : 
                              position >= 90 ? 'open_max' : 
                              `open_${position}%`;
            
            document.getElementById(`${hand}HandValue`).textContent = `${position}% (${statusText})`;
            document.getElementById(`${hand}HandSlider`).value = position;
        }

        async function updateHardwareStatus() {
            try {
                const response = await fetch('/api/hardware');
                if (response.ok) {
                    const data = await response.json();
                    
                    // Update LED
                    updateLedDisplay(data.led_intensity);
                    
                    // Update Hands
                    updateHandDisplay('left', data.hands.left.position);
                    updateHandDisplay('right', data.hands.right.position);
                }
            } catch (error) {
                addLog('ERROR', `Hardware status update failed: ${error.message}`);
            }
        }

        async function updateMemoryDisplay() {
            try {
                const response = await fetch('/api/memory');
                if (response.ok) {
                    const data = await response.json();
                    const memoryDiv = document.getElementById('memoryDisplay');
                    
                    if (data.length === 0) {
                        memoryDiv.innerHTML = '<div class="text-gray-500">Memory banks empty</div>';
                    } else {
                        memoryDiv.innerHTML = data.map(entry => 
                            `<div class="text-blue-600"><span class="text-gray-500">[${entry.timestamp}]</span> ${entry.content}</div>`
                        ).join('');
                    }
                }
            } catch (error) {
                addLog('ERROR', `Memory update failed: ${error.message}`);
            }
        }

        // Voice System Functions
        async function startVoiceServer() {
            const startBtn = document.getElementById('voiceStartBtn');
            const stopBtn = document.getElementById('voiceStopBtn');
            
            try {
                startBtn.disabled = true;
                startBtn.textContent = 'ðŸ”„ STARTING...';
                
                addLog('VOICE', 'Starting Assaultron voice system...');
                updateVoiceStatus(false, 'Starting voice system...', 'Starting', 'Loading');
                
                const response = await fetch('/api/voice/start', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addLog('VOICE', 'Voice system started successfully!');
                    updateVoiceStatus(true, 'Voice system online', 'Running', 'Loaded');
                    
                    startBtn.disabled = true;
                    stopBtn.disabled = false;
                    startBtn.textContent = 'âœ… VOICE ONLINE';
                } else {
                    throw new Error(data.error || 'Failed to start voice system');
                }
                
            } catch (error) {
                addLog('ERROR', `Voice system startup failed: ${error.message}`);
                updateVoiceStatus(false, 'Voice system offline - startup failed', 'Stopped', 'Not loaded');
                
                startBtn.disabled = false;
                startBtn.textContent = 'ðŸš€ START VOICE SERVER';
            }
        }

        async function stopVoiceServer() {
            const startBtn = document.getElementById('voiceStartBtn');
            const stopBtn = document.getElementById('voiceStopBtn');
            
            try {
                stopBtn.disabled = true;
                stopBtn.textContent = 'ðŸ”„ STOPPING...';
                
                addLog('VOICE', 'Stopping voice system...');
                
                const response = await fetch('/api/voice/stop', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addLog('VOICE', 'Voice system stopped');
                    updateVoiceStatus(false, 'Voice system offline', 'Stopped', 'Not loaded');
                    
                    startBtn.disabled = false;
                    stopBtn.disabled = true;
                    startBtn.textContent = 'ðŸš€ START VOICE SERVER';
                    stopBtn.textContent = 'ðŸ›‘ STOP VOICE SERVER';
                } else {
                    throw new Error(data.error || 'Failed to stop voice system');
                }
                
            } catch (error) {
                addLog('ERROR', `Voice system stop failed: ${error.message}`);
                stopBtn.disabled = false;
                stopBtn.textContent = 'ðŸ›‘ STOP VOICE SERVER';
            }
        }

        function updateVoiceStatus(enabled, statusText, serverStatus, modelStatus) {
            const statusTextEl = document.getElementById('voiceStatusText');
            const statusIndicator = document.getElementById('voiceStatusIndicator');
            const serverStatusEl = document.getElementById('serverStatus');
            const modelStatusEl = document.getElementById('modelStatus');
            
            // Update main status
            statusTextEl.textContent = statusText;
            statusTextEl.className = enabled ? 'text-green-500' : 'text-red-500';
            
            // Update status indicator
            statusIndicator.className = enabled ? 
                'w-2 h-2 rounded-full bg-green-500 animate-pulse' : 
                'w-2 h-2 rounded-full bg-red-500';
            
            // Update detailed status
            serverStatusEl.textContent = serverStatus;
            modelStatusEl.textContent = modelStatus;
        }

        async function testSpeechInternal(text) {
            try {
                addLog('VOICE', `Testing speech: "${text}"`);
                
                const response = await fetch('/api/voice/speak', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addLog('VOICE', 'Speech synthesis started');
                    return true;
                } else {
                    throw new Error(data.error || 'Speech synthesis failed');
                }
                
            } catch (error) {
                addLog('ERROR', `Speech test failed: ${error.message}`);
                return false;
            }
        }

        async function testSpeech() {
            const testInput = document.getElementById('testSpeechInput');
            const text = testInput.value.trim();
            
            if (!text) {
                addLog('WARNING', 'No test text provided');
                return;
            }
            
            const success = await testSpeechInternal(text);
            if (success) {
                testInput.value = ''; // Clear input on success
            }
        }

        async function updateVoiceSystemStatus() {
            try {
                const response = await fetch('/api/voice/status');
                if (response.ok) {
                    const status = await response.json();
                    
                    const enabled = status.voice_enabled && status.initialized && status.server_running;
                    const statusText = enabled ? 
                        `Voice system online (${status.model_info?.name || 'Unknown Model'})` :
                        'Voice system offline';
                    
                    const serverStatus = status.server_running ? 'Running' : 'Stopped';
                    const modelStatus = status.model_loaded ? 
                        (status.model_info?.name ? `${status.model_info.name} (${status.model_info.type})` : 'Loaded') :
                        'Not loaded';
                    
                    updateVoiceStatus(enabled, statusText, serverStatus, modelStatus);
                    
                    // Update button states
                    const startBtn = document.getElementById('voiceStartBtn');
                    const stopBtn = document.getElementById('voiceStopBtn');
                    
                    if (enabled) {
                        startBtn.disabled = true;
                        startBtn.textContent = 'âœ… VOICE ONLINE';
                        stopBtn.disabled = false;
                    } else {
                        startBtn.disabled = false;
                        startBtn.textContent = 'ðŸš€ START VOICE SERVER';
                        stopBtn.disabled = true;
                    }
                }
            } catch (error) {
                // Silently fail for status updates to avoid spam
                console.log('Voice status update failed:', error.message);
            }
        }

        // Initialize
        addLog('INFO', 'Interface started');
        updateStats();
        getModelInfo();

        // Periodic updates
        setInterval(updateStats, 2000);  // Update stats every 2 seconds
        setInterval(updateUptime, 1000); // Update uptime every second
        setInterval(() => {
            if (currentTab === 'realBody') {
                updateHardwareStatus();
                updateMemoryDisplay();
                updateVoiceSystemStatus();
            }
        }, 3000); // Update hardware status every 3 seconds when on Real Body tab
    </script>
</body>
</html>